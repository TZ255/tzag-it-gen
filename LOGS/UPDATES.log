2025-11-12T14:19:58Z | AI | Align to Itinerary System: removed bcrypt residues, fixed passport, added HTMX auth fragment, repurposed admin (routes/accommodations), added seed script scaffolding, created /LOGS, updated AGENTS.md.
2025-11-12T14:30:00Z | AI | Admin CRUD: added edit/delete for Routes and Accommodations; new views (edit-route.ejs, edit-accomodation.ejs); updated list views with actions; updated AGENTS.md.
2025-11-12T14:40:00Z | AI | Updated Route schema (origin/destination + fee fields) based on HINTS PDFs; expanded admin create/edit forms to capture fees; extended seed data to reflect example day routes and accommodations.
2025-11-12T14:50:00Z | AI | Simplified fees per feedback: replaced adult/child/crater fees with single park_fee; added isConserved radio + concession fee toggle; route_name in accommodation now selects from DB routes; added small /public/js/ui.js.
2025-11-12T14:55:00Z | AI | Set currency to USD across admin views and seeds; removed TZS conversions and labels; park/concession/transit/vehicle/accommodation amounts are now USD.
2025-11-12T15:05:00Z | AI | Moved isConserved + concession_fee strictly to Accommodations (removed from Routes schema/UI); fixed Route.accomodation schema shape; added user seed (samia/2025).
2025-11-12T15:10:00Z | AI | Implemented login button + HTMX+fallback login flow: updated views/auth/login.ejs, improved /auth/login POST to handle both HTMX and non-HTMX correctly.
2025-11-12T19:30:00Z | AI | Added /dashboard routes and meta; removed balance admin actions and UI; set Total Credited to 0; added /public/css/theme.css per tokens; mounted dashboard router.
2025-11-12T20:00:00Z | AI | Implemented Itinerary model, calculator, and UI flow (list/new/show) under /dashboard/itineraries; added sidebar layout and updated AGENTS.md/CHANGELOG.
2025-11-12T20:10:00Z | AI | Removed non-relevant features (add-funds, services, orders, new-order); cleaned dashboard to focus on itineraries; deleted Booking model; updated admin overview to show itineraries count.
2025-11-12T20:18:00Z | AI | Converted Swahili UI/messages to English: error pages, middleware messages, login meta, alerts/toasts labels, layout lang; updated AGENTS.md examples to English.
2025-11-12T20:28:00Z | AI | Admin Routes form updated: removed adult/children counts and generic park fee; added park fee (adult/child) fields; accommodation select pulls from DB and price is sourced from catalog. Route schema and seeds updated accordingly; itinerary totals now use pax to compute park fees.
2025-11-12T20:40:00Z | AI | Fixed sidebar active state for Admin (set page='admin' across admin renders); removed accommodation selection on Add Route; added search filter for route select on Accommodations form; enhanced ui.js to support select filtering.
2025-11-12T20:46:00Z | AI | Replaced Accommodations route picker with a single searchable input using <datalist> (typeahead) on both add and edit forms; ensured admin pages only highlight Admin in sidebar.
2025-11-12T20:52:00Z | AI | Removed unused front-end JS (filter and toggle helpers) and blog.js include; fixed routes table colspan; confirmed server expects only posted fields and defaults correctly.
2025-11-12T21:05:00Z | AI | Reworked itinerary Step 1: dynamic day rows with route & accommodation datalists; Step 2 replaced with a review page that computes totals from DB; updated server to accept arrays and compute using pax; added minimal JS to add rows.
2025-11-12T21:12:00Z | AI | Removed layout reference to /js/ui.js and deleted the file; kept page-specific scripts inline at the bottom of their EJS files (e.g., Step 1 add-row script).
2025-11-12T21:18:00Z | AI | Added a Remove button per itinerary day row on Step 1; supports removing any row; prevents removing the last row by clearing it instead.
2025-11-12T21:22:00Z | AI | Expanded sidebar: added Admin sub-links (Routes, Accommodations, Users) with proper active state using res.locals.path; Admin top link now only active at /admin.
2025-11-12T21:26:00Z | AI | Hid sidebar on the login page: layout renders a clean, centered login interface when page='auth-login'.
2025-11-12T21:32:00Z | AI | Improved login look: full-viewport auth shell with subtle background, wider card (lg=6), refined copy; added `auth-shell` styles to theme and documented in AGENTS.md.
2025-11-12T21:38:00Z | AI | Fixed narrow login width by replacing grid with a centered auth-card (max-width 520px), adjusted padding and branding; no inline styles used.
2025-11-12T21:44:00Z | AI | Added HTMX loading indicator to login form: spinner shows during request via hx-indicator; added CSS helpers to show/hide indicators.
2025-11-12T21:50:00Z | AI | Login UX: Disable submit button during request and re-enable on response; added inline HTMX event handlers; expanded indicator CSS to support element-level hx-indicator toggling.
2025-11-12T22:00:00Z | AI | Cleaned Edit Route view (removed obsolete fields); updated seed to purge routes/accommodations and repopulate with fresh examples; aligned route names with accommodations; added realistic prices and pax-based park fees.
2025-11-12T22:08:00Z | AI | Removed Route.accomodation from schema and all admin flows; updated admin routes list and edit forms; validated accommodation route_name must match existing Route; updated seeds to stop embedding accommodation in Route.
2025-11-12T22:14:00Z | AI | Admin Routes layout: stacked Add Route and Routes List vertically (single column) instead of side-by-side.
2025-11-12T22:18:00Z | AI | Reverted Admin Routes to two-column layout (Add: lg-4, List: lg-8) and widened Fees column with w-25 to prevent it being too thin.
2025-11-13T12:30:01Z AI - Guard itinerary detail view against missing populated routes to stop runtime errors.
2025-11-13T12:32:19Z AI - Enforce itinerary show route hydration on the server and redirect when referenced routes are missing.
2025-11-13T12:34:30Z AI - Replaced itinerary route-id Set comprehension with explicit loop for junior-friendly readability.
2025-11-13T12:38:05Z AI - Added itinerary delete route plus detail-page button with confirm dialog.
2025-11-13T12:44:53Z AI - Implemented itinerary edit form/routes plus list-level action buttons (view/edit/delete).
2025-11-13T12:51:22Z AI - Populated itinerary edit form fields via route population so only missing routes render blank inputs.
2025-11-13T13:01:42Z AI - Added layout-free itinerary print route/view and updated UI to link via 'Open Print Preview'.
2025-11-13T13:11:12Z AI - Added print-color-adjust CSS so print preview keeps theme colors when exporting.
2025-11-13T13:28:53Z AI - Added inclusions/exclusions text capture plus profit percent to itinerary forms, model, and print view.
2025-11-13T13:56:59Z AI - Swapped itinerary route/accommodation inputs to live select dropdowns backed by IDs and updated server flows accordingly.
2025-11-13T14:17:25Z AI - Added per-day fee breakdown on itinerary review (vehicle, park, transit, accommodation, concession) before saving.
2025-11-13T14:29:43Z AI - Added accommodation price hints to selects and ensured concession fees roll into accommodation totals everywhere.
2025-11-13T14:32:58Z AI - Added profit-inclusive totals on itinerary review (client total = base + profit).
2025-11-13T14:38:06Z AI - Clarified review page accommodation fees (base + concession subtotal) so totals reflect concession fees visibly.
2025-11-16T15:20:00Z | AI | Accommodation schema simplified: removed route_name, price, concession_fee, isConserved; added place and isLuxury. Itinerary days now store per-day adult_price/child_price and totals compute accordingly. Added clientName to itineraries. Updated admin accommodation views, itinerary new/edit/review/show/print flows, calculator, and seed script to reflect new model.
2025-11-16T15:32:00Z | AI | Optimized itinerary day row layout: reduced column widths and used compact controls so all inputs fit on a single row at lg screens (new and edit forms).
2025-11-16T15:45:00Z | AI | Print view updated: removed internal cost cards and Investment Summary; added company logo to header; revamped day cards to show route images aligned right with text left. Added `Route.image` field with admin create/edit inputs and seeded sample image URLs.
2025-11-16T16:00:00Z | AI | Added company contact footer (phone, email, address) to the print view and removed the optimization notice; updated AGENTS.md and docs.
2025-11-16T16:06:00Z | AI | Improved print pagination: added @page margins and page-break-avoid rules for day cards/sections to prevent content being cut between pages.
2025-11-16T16:12:00Z | AI | Fixed itinerary edit saving of accommodation unit prices: carried adult_price/child_price through server normalization so totals and persisted values update correctly.
2025-11-16T16:30:00Z | AI | Added standalone testing preview at /testing/page-1 with inline CSS/JS Machame 6-day overview + FAQs; mounted testing router and documented in AGENTS.md.
2025-11-16T17:00:00Z | AI | Integrated AI-generated itinerary overviews (OpenAI util), added overview field to model, auto-generate on create/edit when missing, and render overview on print view; updated AGENTS.md.
2025-11-16T17:10:00Z | AI | Switched overview generation to the OpenAI Node SDK (chat completions) while keeping fallback behavior; updated docs.
2025-11-16T17:18:00Z | AI | Updated AI overview generation to use the OpenAI Responses API (output_text) with same fallback behavior; docs adjusted.
2025-11-16T17:24:00Z | AI | Expanded itinerary overview to <=200 words and prompt now includes route descriptions plus accommodation context; updated docs.
2025-11-16T17:40:00Z | AI | Added submit-button disable + spinner on itinerary review page to prevent duplicate creation; documented in AGENTS.md.
2025-11-16T17:55:00Z | AI | Replaced route/accommodation selects on itinerary Step 1 with searchable popovers that filter on type and set hidden IDs; documented in AGENTS.md.
